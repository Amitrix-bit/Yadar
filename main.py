import base64
exec((base64.b64decode(b"""ZnJvbSBmbGV0IGltcG9ydCBhcHAsIEFsZXJ0RGlhbG9nLCBFbGV2YXRlZEJ1dHRvbiwgVGV4dFRoZW1lU3R5bGUsIFBhZ2UsIENoZWNrYm94LCBBcHBWaWV3LCBTY3JvbGxNb2RlLCBPdXRsaW5lZEJ1dHRvbiwgRmxvYXRpbmdBY3Rpb25CdXR0b24sIFJvdywgVGV4dCwgVGFiLCBUYWJzLCBUZXh0RmllbGQsIFVzZXJDb250cm9sLCBDb2x1bW4sIGljb25zLCBjb2xvcnMsIEljb25CdXR0b24sIENyb3NzQXhpc0FsaWdubWVudCwgTWFpbkF4aXNBbGlnbm1lbnQKCgpjbGFzcyBUYXNrKFVzZXJDb250cm9sKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0YXNrX25hbWUsIHRhc2tfc3RhdHVzX2NoYW5nZSwgdGFza19kZWxldGUpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuY29tcGxldGVkID0gRmFsc2UKICAgICAgICBzZWxmLnRhc2tfbmFtZSA9IHRhc2tfbmFtZQogICAgICAgIHNlbGYudGFza19zdGF0dXNfY2hhbmdlID0gdGFza19zdGF0dXNfY2hhbmdlCiAgICAgICAgc2VsZi50YXNrX2RlbGV0ZSA9IHRhc2tfZGVsZXRlCgogICAgZGVmIGJ1aWxkKHNlbGYpOgogICAgICAgIHNlbGYuZGlzcGxheV90YXNrID0gQ2hlY2tib3goCiAgICAgICAgICAgIHZhbHVlPUZhbHNlLCBsYWJlbD1zZWxmLnRhc2tfbmFtZSwgb25fY2hhbmdlPXNlbGYuc3RhdHVzX2NoYW5nZWQKICAgICAgICApCiAgICAgICAgc2VsZi5lZGl0X25hbWUgPSBUZXh0RmllbGQoZXhwYW5kPTEpCiAgICAgICAgc2VsZi5kaXNwbGF5X3ZpZXcgPSBSb3coCiAgICAgICAgICAgIGFsaWdubWVudD1NYWluQXhpc0FsaWdubWVudC5TUEFDRV9CRVRXRUVOLAogICAgICAgICAgICB2ZXJ0aWNhbF9hbGlnbm1lbnQ9Q3Jvc3NBeGlzQWxpZ25tZW50LkNFTlRFUiwKICAgICAgICAgICAgY29udHJvbHM9WwogICAgICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3Rhc2ssCiAgICAgICAgICAgICAgICBSb3coCiAgICAgICAgICAgICAgICAgICAgc3BhY2luZz0wLAogICAgICAgICAgICAgICAgICAgIGNvbnRyb2xzPVsKICAgICAgICAgICAgICAgICAgICAgICAgSWNvbkJ1dHRvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb249aWNvbnMuQ1JFQVRFX09VVExJTkVELAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbHRpcD0i2YjbjNix2KfbjNi0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uX2NsaWNrPXNlbGYuZWRpdF9jbGlja2VkLAogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICBJY29uQnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbnMuREVMRVRFX09VVExJTkUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sdGlwPSLYrdiw2YEiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25fY2xpY2s9c2VsZi5kZWxldGVfY2xpY2tlZCwKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgXSwKICAgICAgICApCiAgICAgICAgc2VsZi5lZGl0X3ZpZXcgPSBSb3coCiAgICAgICAgICAgIHZpc2libGU9RmFsc2UsCiAgICAgICAgICAgIGFsaWdubWVudD1NYWluQXhpc0FsaWdubWVudC5TUEFDRV9CRVRXRUVOLAogICAgICAgICAgICB2ZXJ0aWNhbF9hbGlnbm1lbnQ9Q3Jvc3NBeGlzQWxpZ25tZW50LkNFTlRFUiwKICAgICAgICAgICAgY29udHJvbHM9WwogICAgICAgICAgICAgICAgc2VsZi5lZGl0X25hbWUsCiAgICAgICAgICAgICAgICBJY29uQnV0dG9uKAogICAgICAgICAgICAgICAgICAgIGljb249aWNvbnMuRE9ORV9PVVRMSU5FX09VVExJTkVELAogICAgICAgICAgICAgICAgICAgIGljb25fY29sb3I9Y29sb3JzLkdSRUVOLAogICAgICAgICAgICAgICAgICAgIHRvb2x0aXA9Itin2LnZhdin2YQiLAogICAgICAgICAgICAgICAgICAgIG9uX2NsaWNrPXNlbGYuc2F2ZV9jbGlja2VkLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgXSwKICAgICAgICApCiAgICAgICAgcmV0dXJuIENvbHVtbihjb250cm9scz1bc2VsZi5kaXNwbGF5X3ZpZXcsIHNlbGYuZWRpdF92aWV3XSkKCiAgICBhc3luYyBkZWYgZWRpdF9jbGlja2VkKHNlbGYsIGUpOgogICAgICAgIHNlbGYuZWRpdF9uYW1lLnZhbHVlID0gc2VsZi5kaXNwbGF5X3Rhc2subGFiZWwKICAgICAgICBzZWxmLmRpc3BsYXlfdmlldy52aXNpYmxlID0gRmFsc2UKICAgICAgICBzZWxmLmVkaXRfdmlldy52aXNpYmxlID0gVHJ1ZQogICAgICAgIGF3YWl0IHNlbGYudXBkYXRlX2FzeW5jKCkKCiAgICBhc3luYyBkZWYgc2F2ZV9jbGlja2VkKHNlbGYsIGUpOgogICAgICAgIHNlbGYuZGlzcGxheV90YXNrLmxhYmVsID0gc2VsZi5lZGl0X25hbWUudmFsdWUKICAgICAgICBzZWxmLmRpc3BsYXlfdmlldy52aXNpYmxlID0gVHJ1ZQogICAgICAgIHNlbGYuZWRpdF92aWV3LnZpc2libGUgPSBGYWxzZQogICAgICAgIGF3YWl0IHNlbGYudXBkYXRlX2FzeW5jKCkKCiAgICBhc3luYyBkZWYgc3RhdHVzX2NoYW5nZWQoc2VsZiwgZSk6CiAgICAgICAgc2VsZi5jb21wbGV0ZWQgPSBzZWxmLmRpc3BsYXlfdGFzay52YWx1ZQogICAgICAgIGF3YWl0IHNlbGYudGFza19zdGF0dXNfY2hhbmdlKHNlbGYpCgogICAgYXN5bmMgZGVmIGRlbGV0ZV9jbGlja2VkKHNlbGYsIGUpOgogICAgICAgIGF3YWl0IHNlbGYudGFza19kZWxldGUoc2VsZikKCgpjbGFzcyBUb2RvQXBwKFVzZXJDb250cm9sKToKICAgIGRlZiBidWlsZChzZWxmKToKICAgICAgICBzZWxmLm5ld190YXNrID0gVGV4dEZpZWxkKAogICAgICAgICAgICBoaW50X3RleHQ9ItmC2LHYp9ix2Ycg2obaqdin2LEg2qnZhtuM2J8iLAogICAgICAgICAgICBvbl9zdWJtaXQ9c2VsZi5hZGRfY2xpY2tlZCwKICAgICAgICAgICAgZXhwYW5kPVRydWUsCiAgICAgICAgICAgIHRleHRfYWxpZ249IlJJR0hUIgogICAgICAgICkKICAgICAgICBzZWxmLnRhc2tzID0gQ29sdW1uKCkKICAgICAgICBzZWxmLmZpbHRlciA9IFRhYnMoCiAgICAgICAgICAgIHNjcm9sbGFibGU9RmFsc2UsCiAgICAgICAgICAgIHNlbGVjdGVkX2luZGV4PTAsCiAgICAgICAgICAgIG9uX2NoYW5nZT1zZWxmLnRhYnNfY2hhbmdlZCwKICAgICAgICAgICAgdGFicz1bVGFiKHRleHQ9ItmH2YXZhyIpLCBUYWIodGV4dD0i2YHYudin2YQiKSwKICAgICAgICAgICAgICAgICAgVGFiKHRleHQ9Itiq2qnZhduM2YQg2LTYr9mHIildLAogICAgICAgICkKICAgICAgICBzZWxmLml0ZW1zX2xlZnQgPSBUZXh0KCLZh9mF2Ycg2qnYp9mF2YQg2LTYr9mGIiwgdGV4dF9hbGlnbj0iUklHSFQiKQogICAgICAgIHJldHVybiBDb2x1bW4oCiAgICAgICAgICAgIHdpZHRoPTEwMDAsCiAgICAgICAgICAgIGNvbnRyb2xzPVsKICAgICAgICAgICAgICAgIFJvdygKICAgICAgICAgICAgICAgICAgICBjb250cm9scz1bCiAgICAgICAgICAgICAgICAgICAgICAgIEVsZXZhdGVkQnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbj1pY29ucy5TVVBFUlZJU0VEX1VTRVJfQ0lSQ0xFX09VVExJTkVELCB0ZXh0PSJBbWlycmV6YSIsIGNvbG9yPSJncmVlbiIsIGRpc2FibGVkPVRydWUpXQogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIFJvdygKICAgICAgICAgICAgICAgICAgICBjb250cm9scz1bCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubmV3X3Rhc2ssCiAgICAgICAgICAgICAgICAgICAgICAgIEZsb2F0aW5nQWN0aW9uQnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbj1pY29ucy5BREQsIG9uX2NsaWNrPXNlbGYuYWRkX2NsaWNrZWQKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgIENvbHVtbigKICAgICAgICAgICAgICAgICAgICBzcGFjaW5nPTI1LAogICAgICAgICAgICAgICAgICAgIGNvbnRyb2xzPVsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5maWx0ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudGFza3MsCiAgICAgICAgICAgICAgICAgICAgICAgIFJvdygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudD1NYWluQXhpc0FsaWdubWVudC5TUEFDRV9CRVRXRUVOLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVydGljYWxfYWxpZ25tZW50PUNyb3NzQXhpc0FsaWdubWVudC5DRU5URVIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9scz1bCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5pdGVtc19sZWZ0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE91dGxpbmVkQnV0dG9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0PSLYrdiw2YEg2KraqdmF24zZhCDYtNiv2Ycg2YfYpyIsIG9uX2NsaWNrPXNlbGYuY2xlYXJfY2xpY2tlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICBdLAogICAgICAgICkKCiAgICBhc3luYyBkZWYgYWRkX2NsaWNrZWQoc2VsZiwgZSk6CiAgICAgICAgaWYgc2VsZi5uZXdfdGFzay52YWx1ZToKICAgICAgICAgICAgdGFzayA9IFRhc2soc2VsZi5uZXdfdGFzay52YWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi50YXNrX3N0YXR1c19jaGFuZ2UsIHNlbGYudGFza19kZWxldGUpCiAgICAgICAgICAgIHNlbGYudGFza3MuY29udHJvbHMuYXBwZW5kKHRhc2spCiAgICAgICAgICAgIHNlbGYubmV3X3Rhc2sudmFsdWUgPSAiIgogICAgICAgICAgICBhd2FpdCBzZWxmLm5ld190YXNrLmZvY3VzX2FzeW5jKCkKICAgICAgICAgICAgYXdhaXQgc2VsZi51cGRhdGVfYXN5bmMoKQoKICAgIGFzeW5jIGRlZiB0YXNrX3N0YXR1c19jaGFuZ2Uoc2VsZiwgdGFzayk6CiAgICAgICAgYXdhaXQgc2VsZi51cGRhdGVfYXN5bmMoKQoKICAgIGFzeW5jIGRlZiB0YXNrX2RlbGV0ZShzZWxmLCB0YXNrKToKICAgICAgICBzZWxmLnRhc2tzLmNvbnRyb2xzLnJlbW92ZSh0YXNrKQogICAgICAgIGF3YWl0IHNlbGYudXBkYXRlX2FzeW5jKCkKCiAgICBhc3luYyBkZWYgdGFic19jaGFuZ2VkKHNlbGYsIGUpOgogICAgICAgIGF3YWl0IHNlbGYudXBkYXRlX2FzeW5jKCkKCiAgICBhc3luYyBkZWYgY2xlYXJfY2xpY2tlZChzZWxmLCBlKToKICAgICAgICBmb3IgdGFzayBpbiBzZWxmLnRhc2tzLmNvbnRyb2xzWzpdOgogICAgICAgICAgICBpZiB0YXNrLmNvbXBsZXRlZDoKICAgICAgICAgICAgICAgIGF3YWl0IHNlbGYudGFza19kZWxldGUodGFzaykKCiAgICBhc3luYyBkZWYgdXBkYXRlX2FzeW5jKHNlbGYpOgogICAgICAgIHN0YXR1cyA9IHNlbGYuZmlsdGVyLnRhYnNbc2VsZi5maWx0ZXIuc2VsZWN0ZWRfaW5kZXhdLnRleHQKICAgICAgICBjb3VudCA9IDAKICAgICAgICBmb3IgdGFzayBpbiBzZWxmLnRhc2tzLmNvbnRyb2xzOgogICAgICAgICAgICB0YXNrLnZpc2libGUgPSAoCiAgICAgICAgICAgICAgICBzdGF0dXMgPT0gItmH2YXZhyIKICAgICAgICAgICAgICAgIG9yIChzdGF0dXMgPT0gItmB2LnYp9mEIiBhbmQgdGFzay5jb21wbGV0ZWQgPT0gRmFsc2UpCiAgICAgICAgICAgICAgICBvciAoc3RhdHVzID09ICLYqtqp2YXbjNmEINi02K/ZhyIgYW5kIHRhc2suY29tcGxldGVkKQogICAgICAgICAgICApCiAgICAgICAgICAgIGlmIG5vdCB0YXNrLmNvbXBsZXRlZDoKICAgICAgICAgICAgICAgIGNvdW50ICs9IDEKICAgICAgICBzZWxmLml0ZW1zX2xldmFsdWUgPSBmIntjb3VudH0g2KrYudiv2KfYryDaqdin2LHZh9in24wg2YbYp9iq2YXYp9mFIDoiCiAgICAgICAgYXdhaXQgc3VwZXIoKS51cGRhdGVfYXN5bmMoKQoKCmFzeW5jIGRlZiBtYWluKHBhZ2U6IFBhZ2UpOgogICAgcGFnZS50aXRsZSA9ICLbjNin2K/Yp9ixIHwgWWFkYXIiCiAgICBwYWdlLmhvcml6b250YWxfYWxpZ25tZW50ID0gQ3Jvc3NBeGlzQWxpZ25tZW50LkNFTlRFUgogICAgcGFnZS5zY3JvbGwgPSBTY3JvbGxNb2RlLkFEQVBUSVZFCgogICAgYXN5bmMgZGVmIGNsb3NlX2RsZyhlKToKICAgICAgICBkbGdfbW9kYWwub3BlbiA9IEZhbHNlCiAgICAgICAgYXdhaXQgcGFnZS51cGRhdGVfYXN5bmMoKQogICAgZGxnX21vZGFsID0gQWxlcnREaWFsb2coCiAgICAgICAgbW9kYWw9VHJ1ZSwKICAgICAgICB0aXRsZT1UZXh0KCLYudi22YjbjNiqL9mI2LHZiNivIiwKICAgICAgICAgICAgICAgICAgIHRleHRfYWxpZ249IkNFTlRFUiIsCiAgICAgICAgICAgICAgICAgICBjb2xvcj0iYmx1ZSIKICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgY29udGVudD1UZXh0KAogICAgICAgICAgICAi2YTYt9mB2Kcg2YbYp9mFINqp2KfYsdio2LHbjCDZiCDZvtiz2YjYsdivINiu2YjYryDYsdinINmI2KfYsdivINqp2YbbjNiv2Iwg2K/YsSDYtdmI2LHYqiDZhtiv2KfYtNiq2YYg2Kfaqdin2YbYqtiMINio2Ycg2LXZiNix2Kog2KfYqtmI2YXYp9iqINiz2KfYrtiq2Ycg2YXbjNi02YjYryIpLAogICAgICAgIGFjdGlvbnM9WwogICAgICAgICAgICBUZXh0RmllbGQobGFiZWw9ItmG2KfZhSDaqdin2LHYqNix24wiLAogICAgICAgICAgICAgICAgICAgICAgaWNvbj1pY29ucy5QRVJTT04sCiAgICAgICAgICAgICAgICAgICAgICBjb2xvcj0iYmx1ZSIsCiAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9OTAsCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0X2FsaWduPSJMZWZ0IiwKICAgICAgICAgICAgICAgICAgICAgIG1heF9sZW5ndGg9MjAsCgogICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgVGV4dEZpZWxkKGxhYmVsPSLYsdmF2LIg2LnYqNmI2LEiLAogICAgICAgICAgICAgICAgICAgICAgaWNvbj1pY29ucy5QQVNTV09SRCwKICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICBjb2xvcj0iYmx1ZSIsCiAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9OTAsCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0X2FsaWduPSJMZWZ0IiwKICAgICAgICAgICAgICAgICAgICAgIGNhbl9yZXZlYWxfcGFzc3dvcmQ9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgIEVsZXZhdGVkQnV0dG9uKHRleHQ9Itio2LLZhiDYqNix24zZhSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb249aWNvbnMuTE9HSU4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ9InJpZ2h0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgb25fY2xpY2s9Y2xvc2VfZGxnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICBdLAogICAgICAgIGFjdGlvbnNfYWxpZ25tZW50PU1haW5BeGlzQWxpZ25tZW50LkNFTlRFUgogICAgKQogICAgcGFnZS5kaWFsb2cgPSBkbGdfbW9kYWwKICAgIGRsZ19tb2RhbC5vcGVuID0gVHJ1ZQogICAgYXdhaXQgcGFnZS5hZGRfYXN5bmMoVG9kb0FwcCgpKQphcHAobWFpbiwgdmlldz1BcHBWaWV3LldFQl9CUk9XU0VSLCBhc3NldHNfZGlyPSJhc3NldHMiKQo=""")))
